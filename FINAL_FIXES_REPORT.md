# ‚úÖ **–ö–û–ú–ü–õ–ï–ö–°–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï GOOGLE SHEETS - –ó–ê–í–ï–†–®–ï–ù–û**

## üéØ **–°—Ç–∞—Ç—É—Å: –í–°–ï –ü–†–û–ë–õ–ï–ú–´ –ò–°–ü–†–ê–í–õ–ï–ù–´**

---

## üìã **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

### ‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ 1: –¶–µ–Ω–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ = 0** - –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `clean_number()` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–∏—Å–∫ —á–∏—Å–µ–ª –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–æ–∑–≤—Ä–∞—Ç –ø–µ—Ä–≤–æ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞
- Fallback –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–∏–ø–∞ `'–°—Ç–∞–≤–∫–∞ –ù–î–°: –ë–µ–∑ –ù–î–°\n1 200,00 ‚ÇΩ'` —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ `1200.0`

### ‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ 2: –ê–ø–æ—Å—Ç—Ä–æ—Ñ—ã –ø–µ—Ä–µ–¥ —Ñ–æ—Ä–º—É–ª–∞–º–∏** - –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ö–æ—Ä–Ω–µ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –§–æ—Ä–º—É–ª—ã `=0.0-0.0` —Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å —Ç–µ–∫—Å—Ç–æ–º
2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ cell references
3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
- –ó–∞–º–µ–Ω–∞ —Ñ–æ—Ä–º—É–ª —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –Ω–∞ cell references (`=C3-C10`)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º SUM —Ñ–æ—Ä–º—É–ª
- –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ñ–æ—Ä–º—É–ª—ã —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ, –∞ –Ω–µ –∫–∞–∫ —Ç–µ–∫—Å—Ç

---

## üîß **–î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞:**

### **1. –£–ª—É—á—à–µ–Ω–Ω–∞—è `clean_number()` —Ñ—É–Ω–∫—Ü–∏—è**
```python
# –ù–û–í–û–ï: –ò—Å–∫–∞—Ç—å —á–∏—Å–ª–∞ –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫–∞—Ö
for line in lines:
    clean_line = line.replace('‚ÇΩ', '').replace('RUB', '')...
    match = re.search(r'(\d+\.?\d*)', clean_line)
    if match and float(match.group(1)) > 0:
        return float(match.group(1))
```

### **2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—É–ª—ã –≤ `add_contract_to_master()`**
```python
# –ë—ã–ª–æ: f"={contract_price_clean}-{accepted_clean}"
# –°—Ç–∞–ª–æ: "=C3-C10"  (—Ü–µ–Ω–∞ –≤ C3, –ø—Ä–∏–Ω—è—Ç–æ –≤ C10)

# –£–ª—É—á—à–µ–Ω–Ω—ã–µ SUM —Ñ–æ—Ä–º—É–ª—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π:
if last_row > start_data_row:
    source_total_formula = f"=SUM(E{start_data_row}:E{last_row})"
```

### **3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–∫–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
- –ü—Ä–∏–º–µ–Ω–µ–Ω—ã —Ç–µ –∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫ `add_contracts_by_year()`
- –ü—Ä–∏–º–µ–Ω–µ–Ω—ã —Ç–µ –∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫ `add_contracts_to_single_sheet()`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Ü–µ–Ω

### **4. –î–æ–±–∞–≤–ª–µ–Ω–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
```python
# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –æ—á–∏—Å—Ç–∫–∏ —á–∏—Å–µ–ª
logging.info(f"Contract {contract.get('reestr_number')} - "
            f"Raw: {contract_price_raw}, Clean: {contract_price_clean}")

# –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏ —Ü–µ–Ω–µ = 0
if contract_price_clean <= 0:
    bot.send_message(chat_id, "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –¶–µ–Ω–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é...")
```

---

## üß™ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

### **Unit —Ç–µ—Å—Ç—ã `clean_number()`:**
```
üìä Results: 12 passed, 0 failed
üéØ Success rate: 100.0%
üéâ All tests passed!
```

**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–µ–π—Å—ã:**
- ‚úÖ –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ù–î–°
- ‚úÖ –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏  
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ —á–∏—Å–ª–∞ —Å –≤–∞–ª—é—Ç–æ–π
- ‚úÖ –î–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏ (–∑–∞–ø—è—Ç–∞—è/—Ç–æ—á–∫–∞)
- ‚úÖ –ù—É–ª–µ–≤—ã–µ –∏ –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å —á–∏—Å–ª–∞–º–∏

### **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Google Sheets API —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–∞–º –≤–∫–ª—é—á–µ–Ω

---

## üìä **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Google Sheets:**

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
```
| –ö–æ–Ω—Ç—Ä–∞–∫—Ç    | –¶–µ–Ω–∞    | –û—Å—Ç–∞—Ç–æ–∫ –ª–∏–º–∏—Ç–∞ |
|-------------|---------|----------------|
| 339170...   | 0.0     | =0.0-0.0      |  ‚Üê –ù–µ–≤–µ—Ä–Ω–æ
| –ö-000001    | 0.0     | =0.0-0.0      |  ‚Üê –ù–µ–≤–µ—Ä–Ω–æ
```

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
```
| –ö–æ–Ω—Ç—Ä–∞–∫—Ç    | –¶–µ–Ω–∞    | –û—Å—Ç–∞—Ç–æ–∫ –ª–∏–º–∏—Ç–∞ |
|-------------|---------|----------------|
| 339170...   | 1200.0  | =C3-C10         |  ‚Üê –ü—Ä–∞–≤–∏–ª—å–Ω–æ!
| –ö-000001    | 1200.0  | =C3-C10         |  ‚Üê –ü—Ä–∞–≤–∏–ª—å–Ω–æ!
```

### **–¢–æ–≤–∞—Ä–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ñ–æ—Ä–º—É–ª–∞–º–∏:**
```
| –ö–æ–ª-–≤–æ | –¶–µ–Ω–∞  | –°—É–º–º–∞ (–†–∞—Å—á–µ—Ç) |
|---------|-------|-----------------|
| 133     | 9.04  | =B14*D14        |  ‚Üê –ü—Ä–∞–≤–∏–ª—å–Ω–æ
| 1457    | 144.1 | =B15*D15        |  ‚Üê –ü—Ä–∞–≤–∏–ª—å–Ω–æ
| –ò–¢–û–ì–û   |        | =SUM(E14:E15)   |  ‚Üê –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
```

---

## üöÄ **–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|-----------|---------|---------|
| –ë–æ—Ç | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | PID 55632, –±–µ–∑ –æ—à–∏–±–æ–∫ |
| Telegram API | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –°–æ–æ–±—â–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è |
| –£–¥–∞–ª–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | SSH + Playwright |
| Google Sheets | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –§–æ—Ä–º—É–ª—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã |
| –¶–µ–Ω—ã | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã | –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| –§–æ—Ä–º—É–ª—ã | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã | Cell references |
| Unit —Ç–µ—Å—Ç—ã | ‚úÖ –ü—Ä–æ–π–¥–µ–Ω—ã | 100% success rate |

---

## üéØ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –¥–ª—è:**

1. **–®–∞–±–ª–æ–Ω–æ–≤ —Ç–∞–±–ª–∏—Ü** - –≤—Å–µ —Ä–∞—Å—á–µ—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. **–ü–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏** - —Ñ–æ—Ä–º—É–ª—ã –≤ batch —Ä–µ–∂–∏–º–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã  
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º
4. **–ë—É–¥—É—â–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é

---

## üéâ **–ò–¢–û–ì–û–í–´–ô –í–ï–†–î–ò–ö–¢:**

### ‚úÖ **–í–°–ï –ü–†–û–ë–õ–ï–ú–´ –ò–°–ü–†–ê–í–õ–ï–ù–´**

1. **–¶–µ–Ω–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–§–æ—Ä–º—É–ª—ã:** –†–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∞–ø–æ—Å—Ç—Ä–æ—Ñ–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ cell references  
3. **–°—É–º–º—ã:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è
4. **–î–∏–∞–ø–∞–∑–æ–Ω—ã:** –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —è—á–µ–π–∫–∏ –≤ —Ñ–æ—Ä–º—É–ª–∞—Ö SUM
5. **–û—Ç–ª–∞–¥–∫–∞:** –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## üîÑ **–ü–æ—Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏** —Å —Ä–∞–∑–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ —Ü–µ–Ω
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º—É–ª—ã –≤ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö**
3. **–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—á–µ—Ç—ã —Å—É–º–º**
4. **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –≤–Ω–µ—Å—Ç–∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏**

---

## üìù **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**

- **Commit:** `a137621`
- **–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:** `bot.py`, `test_clean_number.py`
- **Unit —Ç–µ—Å—Ç—ã:** 100% pass rate
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö!** üéâ

---

*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã: 5 —Ñ–µ–≤—Ä–∞–ª—è 2026*